

<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MotoT√°xi Tapau√° - Conectando voc√™ ao seu destino</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#000000',
            secondary: '#00D4AA',
            accent: '#FFB800'
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-sm border-b">
    <div class="container mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="bg-primary text-white p-2 rounded-lg">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z"/>
            </svg>
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-900">MotoT√°xi Tapau√°</h1>
            <p class="text-sm text-gray-500">Conectando voc√™ ao seu destino</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button id="btn-passageiro" onclick="mostrarInterface('passageiro')" 
                  class="px-4 py-2 bg-primary text-white rounded-lg font-medium transition-all hover:bg-gray-800">
            Passageiro
          </button>
          <button id="btn-motorista" onclick="mostrarInterface('motorista')" 
                  class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium transition-all hover:bg-gray-50">
            Motorista
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Interface do Passageiro -->
  <div id="interface-passageiro" class="container mx-auto px-4 py-8 max-w-md">
    <!-- Solicitar Corrida -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
      <div class="text-center mb-6">
        <div class="bg-secondary/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
          </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900 mb-2">Para onde vamos?</h2>
        <p class="text-gray-600">Solicite sua corrida agora</p>
      </div>

      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">üìç Origem</label>
          <div class="relative">
            <input type="text" id="origem" placeholder="Digite o local de partida ou use GPS" 
                   class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-secondary focus:border-transparent">
            <button id="btn-gps-origem" onclick="obterLocalizacaoAtual('origem')" 
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary hover:text-green-600 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
            </button>
          </div>
          <div id="sugestoes-origem" class="hidden mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto"></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">üéØ Destino</label>
          <div class="relative">
            <input type="text" id="destino" placeholder="Digite o destino ou use GPS" 
                   class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-secondary focus:border-transparent">
            <button id="btn-gps-destino" onclick="obterLocalizacaoAtual('destino')" 
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary hover:text-green-600 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
            </button>
          </div>
          <div id="sugestoes-destino" class="hidden mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto"></div>
        </div>
      </div>

      <div class="bg-gray-50 rounded-xl p-4 mb-6">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="bg-primary text-white p-2 rounded-lg">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z"/>
              </svg>
            </div>
            <div>
              <p class="font-semibold text-gray-900">MotoT√°xi</p>
              <p class="text-sm text-gray-600">R√°pido e econ√¥mico</p>
            </div>
          </div>
          <div class="text-right">
            <p class="text-xl font-bold text-gray-900">R$ 5,00</p>
            <p class="text-sm text-gray-500">Pre√ßo fixo</p>
          </div>
        </div>
      </div>

      <button id="btn-solicitar" onclick="solicitarCorrida()" 
              class="w-full bg-primary hover:bg-gray-800 text-white font-semibold py-4 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
        üöÄ Solicitar MotoT√°xi
      </button>
    </div>

    <!-- Status da Corrida -->
    <div id="status-corrida" class="bg-white rounded-2xl shadow-lg p-6 hidden">
      <div class="text-center">
        <div id="status-icon" class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <!-- √çcone ser√° inserido dinamicamente -->
        </div>
        <h3 id="status-titulo" class="text-xl font-bold text-gray-900 mb-2"></h3>
        <p id="status-descricao" class="text-gray-600 mb-6"></p>
        
        <div id="info-motorista" class="bg-gray-50 rounded-xl p-4 mb-4 hidden">
          <div class="flex items-center gap-3">
            <div class="bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg">
              M
            </div>
            <div class="text-left">
              <p id="nome-motorista" class="font-semibold text-gray-900"></p>
              <p class="text-sm text-gray-600">Seu motorista</p>
            </div>
          </div>
        </div>

        <button id="btn-cancelar" onclick="cancelarCorrida()" 
                class="w-full border border-red-300 text-red-600 hover:bg-red-50 font-medium py-3 rounded-xl transition-all">
          Cancelar Corrida
        </button>
      </div>
    </div>
  </div>

  <!-- Interface do Motorista -->
  <div id="interface-motorista" class="container mx-auto px-4 py-8 max-w-md hidden">
    <!-- Cadastro/Login -->
    <div id="cadastro-motorista" class="bg-white rounded-2xl shadow-lg p-6 mb-6">
      <div class="text-center mb-6">
        <div class="bg-accent/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900 mb-2">Seja um Parceiro</h2>
        <p class="text-gray-600">Cadastre-se e comece a ganhar</p>
      </div>

      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Nome completo</label>
          <input type="text" id="nome-motorista-input" placeholder="Digite seu nome completo" 
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
          <input type="tel" id="telefone-motorista" placeholder="(XX) XXXXX-XXXX" 
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Idade</label>
          <input type="number" id="idade-motorista" placeholder="Digite sua idade" min="18" max="80"
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
        </div>
      </div>

      <button onclick="cadastrarMotorista()" 
              class="w-full bg-accent hover:bg-yellow-500 text-white font-semibold py-4 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
        Cadastrar como Motorista
      </button>
    </div>

    <!-- Dashboard do Motorista -->
    <div id="dashboard-motorista" class="hidden">
      <!-- Status Online/Offline -->
      <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
        <div class="flex items-center justify-between mb-4">
          <div>
            <h3 class="text-lg font-bold text-gray-900">Status</h3>
            <p id="status-motorista-texto" class="text-sm text-gray-600">Voc√™ est√° offline</p>
          </div>
          <button id="toggle-status" onclick="toggleStatusMotorista()" 
                  class="bg-gray-300 relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none">
            <span id="toggle-circle" class="inline-block h-6 w-6 transform rounded-full bg-white transition-transform translate-x-1"></span>
          </button>
        </div>
        
        <div class="grid grid-cols-2 gap-4 text-center">
          <div class="bg-green-50 rounded-xl p-3">
            <p class="text-2xl font-bold text-green-600" id="corridas-hoje">0</p>
            <p class="text-sm text-gray-600">Corridas hoje</p>
          </div>
          <div class="bg-blue-50 rounded-xl p-3">
            <p class="text-2xl font-bold text-blue-600" id="ganhos-hoje">R$ 0</p>
            <p class="text-sm text-gray-600">Ganhos hoje</p>
          </div>
        </div>
      </div>

      <!-- Corridas Dispon√≠veis -->
      <div class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-900 mb-4">Corridas Dispon√≠veis</h3>
        <div id="corridas-disponiveis">
          <div class="text-center py-8 text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p>Aguardando corridas...</p>
            <p class="text-sm">Fique online para receber solicita√ß√µes</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <script>
    // Estado da aplica√ß√£o
    let motoristas = JSON.parse(localStorage.getItem('motoristas') || '[]');
    let corridas = JSON.parse(localStorage.getItem('corridas') || '[]');
    let motoristaLogado = JSON.parse(localStorage.getItem('motoristaLogado') || 'null');
    let corridaAtual = null;
    let statusMotorista = false;
    let estatisticas = JSON.parse(localStorage.getItem('estatisticas') || '{"corridas": 0, "ganhos": 0}');
    let localizacaoAtual = null;

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      mostrarInterface('passageiro');
      if (motoristaLogado) {
        mostrarDashboardMotorista();
      }
      atualizarEstatisticas();
      verificarCorridasPendentes();
      configurarAutoComplete();
    });

    // Navega√ß√£o entre interfaces
    function mostrarInterface(tipo) {
      const passageiroDiv = document.getElementById('interface-passageiro');
      const motoristaDiv = document.getElementById('interface-motorista');
      const btnPassageiro = document.getElementById('btn-passageiro');
      const btnMotorista = document.getElementById('btn-motorista');

      if (tipo === 'passageiro') {
        passageiroDiv.classList.remove('hidden');
        motoristaDiv.classList.add('hidden');
        btnPassageiro.className = 'px-4 py-2 bg-primary text-white rounded-lg font-medium transition-all hover:bg-gray-800';
        btnMotorista.className = 'px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium transition-all hover:bg-gray-50';
      } else {
        passageiroDiv.classList.add('hidden');
        motoristaDiv.classList.remove('hidden');
        btnPassageiro.className = 'px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium transition-all hover:bg-gray-50';
        btnMotorista.className = 'px-4 py-2 bg-primary text-white rounded-lg font-medium transition-all hover:bg-gray-800';
      }
    }

    // Fun√ß√µes do Passageiro
    function solicitarCorrida() {
      const origem = document.getElementById('origem').value.trim();
      const destino = document.getElementById('destino').value.trim();

      if (!origem || !destino) {
        mostrarToast('Por favor, preencha origem e destino', 'error');
        return;
      }

      const corrida = {
        id: Date.now(),
        origem,
        destino,
        status: 'aguardando',
        criadaEm: new Date().toISOString(),
        valor: 5.00,
        motoristaId: null,
        nomeMotorista: null
      };

      corridas.push(corrida);
      corridaAtual = corrida;
      salvarDados();

      mostrarStatusCorrida('aguardando');
      mostrarToast('Corrida solicitada! Procurando motorista...', 'info');
      
      // Simular notifica√ß√£o para motoristas online
      notificarMotoristasOnline(corrida);
    }

    function mostrarStatusCorrida(status) {
      const solicitarDiv = document.querySelector('#interface-passageiro > div:first-child');
      const statusDiv = document.getElementById('status-corrida');
      const statusIcon = document.getElementById('status-icon');
      const statusTitulo = document.getElementById('status-titulo');
      const statusDescricao = document.getElementById('status-descricao');
      const infoMotorista = document.getElementById('info-motorista');

      solicitarDiv.classList.add('hidden');
      statusDiv.classList.remove('hidden');

      switch(status) {
        case 'aguardando':
          statusIcon.className = 'w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-yellow-100 animate-pulse';
          statusIcon.innerHTML = '<svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>';
          statusTitulo.textContent = 'Procurando motorista...';
          statusDescricao.textContent = 'Aguarde enquanto encontramos um motorista pr√≥ximo a voc√™';
          infoMotorista.classList.add('hidden');
          break;
        case 'aceita':
          statusIcon.className = 'w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-green-100';
          statusIcon.innerHTML = '<svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>';
          statusTitulo.textContent = 'Corrida aceita!';
          statusDescricao.textContent = 'O motorista est√° a caminho do local de partida';
          infoMotorista.classList.remove('hidden');
          document.getElementById('nome-motorista').textContent = corridaAtual.nomeMotorista;
          break;
        case 'finalizada':
          statusIcon.className = 'w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-blue-100';
          statusIcon.innerHTML = '<svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>';
          statusTitulo.textContent = 'Corrida finalizada!';
          statusDescricao.textContent = 'Obrigado por usar nosso servi√ßo. Avalie sua experi√™ncia!';
          infoMotorista.classList.remove('hidden');
          setTimeout(() => {
            voltarParaSolicitacao();
          }, 3000);
          break;
      }
    }

    function cancelarCorrida() {
      if (corridaAtual) {
        const index = corridas.findIndex(c => c.id === corridaAtual.id);
        if (index > -1) {
          corridas.splice(index, 1);
          salvarDados();
        }
      }
      voltarParaSolicitacao();
      mostrarToast('Corrida cancelada', 'info');
    }

    function voltarParaSolicitacao() {
      const solicitarDiv = document.querySelector('#interface-passageiro > div:first-child');
      const statusDiv = document.getElementById('status-corrida');
      
      solicitarDiv.classList.remove('hidden');
      statusDiv.classList.add('hidden');
      
      // Limpar campos
      document.getElementById('origem').value = '';
      document.getElementById('destino').value = '';
      corridaAtual = null;
    }

    // Fun√ß√µes do Motorista
    function cadastrarMotorista() {
      const nome = document.getElementById('nome-motorista-input').value.trim();
      const telefone = document.getElementById('telefone-motorista').value.trim();
      const idade = document.getElementById('idade-motorista').value.trim();

      if (!nome || !telefone || !idade) {
        mostrarToast('Por favor, preencha todos os campos', 'error');
        return;
      }

      if (parseInt(idade) < 18 || parseInt(idade) > 80) {
        mostrarToast('A idade deve estar entre 18 e 80 anos', 'error');
        return;
      }

      const motorista = {
        id: Date.now(),
        nome,
        telefone,
        idade: parseInt(idade),
        cadastradoEm: new Date().toISOString(),
        online: false
      };

      motoristas.push(motorista);
      motoristaLogado = motorista;
      salvarDados();

      mostrarDashboardMotorista();
      mostrarToast('Cadastro realizado com sucesso!', 'success');
    }

    function mostrarDashboardMotorista() {
      document.getElementById('cadastro-motorista').classList.add('hidden');
      document.getElementById('dashboard-motorista').classList.remove('hidden');
      atualizarEstatisticas();
    }

    function toggleStatusMotorista() {
      statusMotorista = !statusMotorista;
      const toggle = document.getElementById('toggle-status');
      const circle = document.getElementById('toggle-circle');
      const statusTexto = document.getElementById('status-motorista-texto');

      if (statusMotorista) {
        toggle.className = 'bg-green-500 relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none';
        circle.className = 'inline-block h-6 w-6 transform rounded-full bg-white transition-transform translate-x-7';
        statusTexto.textContent = 'Voc√™ est√° online';
        mostrarToast('Voc√™ est√° online! Aguardando corridas...', 'success');
      } else {
        toggle.className = 'bg-gray-300 relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none';
        circle.className = 'inline-block h-6 w-6 transform rounded-full bg-white transition-transform translate-x-1';
        statusTexto.textContent = 'Voc√™ est√° offline';
        mostrarToast('Voc√™ est√° offline', 'info');
      }

      if (motoristaLogado) {
        motoristaLogado.online = statusMotorista;
        const index = motoristas.findIndex(m => m.id === motoristaLogado.id);
        if (index > -1) {
          motoristas[index] = motoristaLogado;
          salvarDados();
        }
      }

      atualizarCorridasDisponiveis();
    }

    function aceitarCorrida(corridaId) {
      const corrida = corridas.find(c => c.id === corridaId);
      if (corrida && corrida.status === 'aguardando') {
        corrida.status = 'aceita';
        corrida.motoristaId = motoristaLogado.id;
        corrida.nomeMotorista = motoristaLogado.nome;
        corrida.aceitaEm = new Date().toISOString();
        
        salvarDados();
        atualizarCorridasDisponiveis();
        mostrarToast('Corrida aceita! Dirija-se ao local de partida', 'success');
        
        // Atualizar status para o passageiro
        if (corridaAtual && corridaAtual.id === corridaId) {
          corridaAtual = corrida;
          mostrarStatusCorrida('aceita');
        }
      }
    }

    function finalizarCorrida(corridaId) {
      const corrida = corridas.find(c => c.id === corridaId);
      if (corrida && corrida.status === 'aceita' && corrida.motoristaId === motoristaLogado.id) {
        corrida.status = 'finalizada';
        corrida.finalizadaEm = new Date().toISOString();
        
        // Atualizar estat√≠sticas
        estatisticas.corridas += 1;
        estatisticas.ganhos += 4; // R$ 4 para o motorista
        
        salvarDados();
        atualizarCorridasDisponiveis();
        atualizarEstatisticas();
        mostrarToast('Corrida finalizada! Voc√™ ganhou R$ 4,00', 'success');
        
        // Atualizar status para o passageiro
        if (corridaAtual && corridaAtual.id === corridaId) {
          corridaAtual = corrida;
          mostrarStatusCorrida('finalizada');
        }
      }
    }

    function atualizarCorridasDisponiveis() {
      const container = document.getElementById('corridas-disponiveis');
      const corridasAguardando = corridas.filter(c => c.status === 'aguardando');
      const corridasAceitas = corridas.filter(c => c.status === 'aceita' && c.motoristaId === motoristaLogado?.id);

      if (!statusMotorista || (corridasAguardando.length === 0 && corridasAceitas.length === 0)) {
        container.innerHTML = `
          <div class="text-center py-8 text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p>Aguardando corridas...</p>
            <p class="text-sm">${statusMotorista ? 'Fique atento √†s novas solicita√ß√µes' : 'Fique online para receber solicita√ß√µes'}</p>
          </div>
        `;
        return;
      }

      container.innerHTML = '';

      // Mostrar corridas aceitas pelo motorista
      corridasAceitas.forEach(corrida => {
        const div = document.createElement('div');
        div.className = 'border-2 border-green-200 bg-green-50 rounded-xl p-4 mb-4';
        div.innerHTML = `
          <div class="flex justify-between items-start mb-3">
            <div>
              <p class="font-semibold text-gray-900">üìç ${corrida.origem}</p>
              <p class="text-gray-600">üéØ ${corrida.destino}</p>
            </div>
            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">
              Em andamento
            </span>
          </div>
          <div class="flex justify-between items-center">
            <p class="text-lg font-bold text-green-600">R$ 5,00</p>
            <button onclick="finalizarCorrida(${corrida.id})" 
                    class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
              Finalizar Corrida
            </button>
          </div>
        `;
        container.appendChild(div);
      });

      // Mostrar corridas dispon√≠veis
      corridasAguardando.forEach(corrida => {
        const div = document.createElement('div');
        div.className = 'border border-gray-200 bg-white rounded-xl p-4 mb-4 hover:shadow-md transition-shadow';
        div.innerHTML = `
          <div class="flex justify-between items-start mb-3">
            <div>
              <p class="font-semibold text-gray-900">üìç ${corrida.origem}</p>
              <p class="text-gray-600">üéØ ${corrida.destino}</p>
              <p class="text-sm text-gray-500">Solicitada h√° ${calcularTempoDecorrido(corrida.criadaEm)}</p>
            </div>
            <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">
              Dispon√≠vel
            </span>
          </div>
          <div class="flex justify-between items-center">
            <p class="text-lg font-bold text-gray-900">R$ 5,00</p>
            <button onclick="aceitarCorrida(${corrida.id})" 
                    class="bg-primary hover:bg-gray-800 text-white px-4 py-2 rounded-lg font-medium transition-colors">
              Aceitar Corrida
            </button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function atualizarEstatisticas() {
      document.getElementById('corridas-hoje').textContent = estatisticas.corridas;
      document.getElementById('ganhos-hoje').textContent = `R$ ${estatisticas.ganhos}`;
    }

    // Fun√ß√µes de Geolocaliza√ß√£o
    function obterLocalizacaoAtual(campo) {
      const botao = document.getElementById(`btn-gps-${campo}`);
      const input = document.getElementById(campo);
      
      // Mostrar loading no bot√£o
      botao.innerHTML = `
        <svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
        </svg>
      `;
      
      if (!navigator.geolocation) {
        mostrarToast('GPS n√£o dispon√≠vel neste dispositivo', 'error');
        restaurarBotaoGPS(botao);
        return;
      }

      const opcoes = {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 60000
      };

      navigator.geolocation.getCurrentPosition(
        function(posicao) {
          const lat = posicao.coords.latitude;
          const lng = posicao.coords.longitude;
          
          localizacaoAtual = { lat, lng };
          
          // Converter coordenadas em endere√ßo
          obterEnderecoReverso(lat, lng, campo);
          
          mostrarToast('Localiza√ß√£o obtida com sucesso!', 'success');
          restaurarBotaoGPS(botao);
        },
        function(erro) {
          let mensagem = 'Erro ao obter localiza√ß√£o';
          
          switch(erro.code) {
            case erro.PERMISSION_DENIED:
              mensagem = 'Permiss√£o de localiza√ß√£o negada. Ative o GPS e permita o acesso.';
              break;
            case erro.POSITION_UNAVAILABLE:
              mensagem = 'Localiza√ß√£o indispon√≠vel. Verifique se o GPS est√° ativo.';
              break;
            case erro.TIMEOUT:
              mensagem = 'Tempo limite para obter localiza√ß√£o. Tente novamente.';
              break;
          }
          
          mostrarToast(mensagem, 'error');
          restaurarBotaoGPS(botao);
        },
        opcoes
      );
    }

    function restaurarBotaoGPS(botao) {
      botao.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
        </svg>
      `;
    }

    function obterEnderecoReverso(lat, lng, campo) {
      // Simula√ß√£o de geocodifica√ß√£o reversa com locais conhecidos de Tapau√°-AM
      const locaisConhecidos = [
        { nome: "Centro de Tapau√°", lat: -5.1, lng: -63.2, raio: 0.01 },
        { nome: "Porto de Tapau√°", lat: -5.11, lng: -63.19, raio: 0.01 },
        { nome: "Mercado Municipal", lat: -5.09, lng: -63.21, raio: 0.01 },
        { nome: "Igreja Matriz", lat: -5.1, lng: -63.2, raio: 0.005 },
        { nome: "Prefeitura Municipal", lat: -5.098, lng: -63.201, raio: 0.008 },
        { nome: "Hospital Municipal", lat: -5.102, lng: -63.198, raio: 0.01 },
        { nome: "Escola Estadual Amazonas", lat: -5.12, lng: -63.18, raio: 0.01 },
        { nome: "Terminal Rodovi√°rio", lat: -5.095, lng: -63.205, raio: 0.01 },
        { nome: "Banco do Brasil", lat: -5.099, lng: -63.199, raio: 0.005 },
        { nome: "Feira Livre", lat: -5.101, lng: -63.202, raio: 0.008 },
        { nome: "Vila Nova", lat: -5.105, lng: -63.195, raio: 0.015 },
        { nome: "Beira Rio", lat: -5.108, lng: -63.188, raio: 0.012 },
        { nome: "Setor Comercial", lat: -5.097, lng: -63.203, raio: 0.01 },
        { nome: "Pra√ßa Central", lat: -5.1, lng: -63.2, raio: 0.005 }
      ];

      let enderecoEncontrado = null;
      
      for (let local of locaisConhecidos) {
        const distancia = Math.sqrt(
          Math.pow(lat - local.lat, 2) + Math.pow(lng - local.lng, 2)
        );
        
        if (distancia <= local.raio) {
          enderecoEncontrado = local.nome;
          break;
        }
      }

      if (!enderecoEncontrado) {
        // Se n√£o encontrou um local conhecido, usar o centro como refer√™ncia
        enderecoEncontrado = "Centro de Tapau√°";
      }

      document.getElementById(campo).value = enderecoEncontrado;
    }

    // Configurar autocomplete para endere√ßos
    function configurarAutoComplete() {
      const enderecosTapaua = [
        // Bairros e Regi√µes
        "Centro de Tapau√°",
        "Vila Nova",
        "Beira Rio", 
        "Setor Comercial",
        "Vila S√£o Jos√©",
        "Conjunto Habitacional",
        "√Årea Portu√°ria",
        "Zona Rural",
        
        // Estabelecimentos Comerciais
        "Mercado Municipal",
        "Supermercado Central",
        "Supermercado S√£o Jos√©",
        "Mercadinho da Vila",
        "Farm√°cia Central",
        "Farm√°cia S√£o Paulo",
        "Drogaria Popular",
        "Padaria S√£o Jos√©",
        "Padaria Central",
        "A√ßougue do Centro",
        "Loja de Roupas Elegante",
        "Casa de Materiais de Constru√ß√£o",
        "Loja de Eletrodom√©sticos",
        "Papelaria Escolar",
        
        // Servi√ßos P√∫blicos
        "Prefeitura Municipal",
        "C√¢mara Municipal",
        "F√≥rum de Tapau√°",
        "Delegacia de Pol√≠cia",
        "Corpo de Bombeiros",
        "Correios",
        "Cart√≥rio",
        "Receita Federal",
        "INSS",
        
        // Bancos e Financeiras
        "Banco do Brasil",
        "Caixa Econ√¥mica Federal",
        "Bradesco",
        "Banco da Amaz√¥nia",
        "Lot√©rica",
        "Casa Lot√©rica Central",
        
        // Sa√∫de
        "Hospital Municipal",
        "Posto de Sa√∫de Central",
        "UBS Vila Nova",
        "Cl√≠nica M√©dica",
        "Laborat√≥rio de An√°lises",
        "Consult√≥rio Odontol√≥gico",
        
        // Educa√ß√£o
        "Escola Municipal Jos√© da Silva",
        "Escola Estadual Amazonas",
        "Col√©gio S√£o Jos√©",
        "Creche Municipal",
        "Centro de Educa√ß√£o Infantil",
        
        // Transporte e Combust√≠vel
        "Terminal Rodovi√°rio",
        "Porto de Tapau√°",
        "Posto de Combust√≠vel BR",
        "Posto Shell",
        "Oficina Mec√¢nica Central",
        "Borracharia",
        
        // Lazer e Cultura
        "Pra√ßa Central",
        "Pra√ßa da Igreja",
        "Campo de Futebol Municipal",
        "Quadra Poliesportiva",
        "Centro Cultural",
        "Biblioteca Municipal",
        
        // Religioso
        "Igreja Matriz",
        "Igreja Assembleia de Deus",
        "Igreja Batista",
        "Igreja Universal",
        "Capela S√£o Jos√©",
        
        // Outros Pontos
        "Cemit√©rio Municipal",
        "Feira Livre",
        "Mercado de Peixe",
        "Rodovi√°ria",
        "Aeroporto Regional",
        "Marina",
        "Clube Social",
        "Hotel Tapau√°",
        "Pousada Central",
        "Restaurante do Porto",
        "Lanchonete da Pra√ßa",
        "Pizzaria Bella Vista"
      ];

      configurarCampoAutoComplete('origem', enderecosTapaua);
      configurarCampoAutoComplete('destino', enderecosTapaua);
    }

    function configurarCampoAutoComplete(campoId, sugestoes) {
      const input = document.getElementById(campoId);
      const containerSugestoes = document.getElementById(`sugestoes-${campoId}`);

      input.addEventListener('input', function() {
        const valor = this.value.toLowerCase();
        
        if (valor.length < 2) {
          containerSugestoes.classList.add('hidden');
          return;
        }

        const sugestoesFiltradas = sugestoes.filter(endereco => 
          endereco.toLowerCase().includes(valor)
        );

        if (sugestoesFiltradas.length === 0) {
          containerSugestoes.classList.add('hidden');
          return;
        }

        containerSugestoes.innerHTML = '';
        containerSugestoes.classList.remove('hidden');

        sugestoesFiltradas.slice(0, 5).forEach(endereco => {
          const div = document.createElement('div');
          div.className = 'px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0';
          div.textContent = endereco;
          
          div.addEventListener('click', function() {
            input.value = endereco;
            containerSugestoes.classList.add('hidden');
          });
          
          containerSugestoes.appendChild(div);
        });
      });

      // Fechar sugest√µes ao clicar fora
      document.addEventListener('click', function(e) {
        if (!input.contains(e.target) && !containerSugestoes.contains(e.target)) {
          containerSugestoes.classList.add('hidden');
        }
      });
    }

    // Fun√ß√µes auxiliares
    function notificarMotoristasOnline(corrida) {
      // Simular notifica√ß√£o em tempo real
      setTimeout(() => {
        atualizarCorridasDisponiveis();
      }, 1000);
    }

    function verificarCorridasPendentes() {
      // Verificar se h√° corridas pendentes para o passageiro
      const corridaPendente = corridas.find(c => c.status !== 'finalizada' && c.status !== 'cancelada');
      if (corridaPendente) {
        corridaAtual = corridaPendente;
        if (corridaPendente.status === 'aguardando') {
          mostrarStatusCorrida('aguardando');
        } else if (corridaPendente.status === 'aceita') {
          mostrarStatusCorrida('aceita');
        }
      }
    }

    function calcularTempoDecorrido(dataISO) {
      const agora = new Date();
      const data = new Date(dataISO);
      const diffMs = agora - data;
      const diffMins = Math.floor(diffMs / 60000);
      
      if (diffMins < 1) return 'agora';
      if (diffMins === 1) return '1 minuto';
      if (diffMins < 60) return `${diffMins} minutos`;
      
      const diffHours = Math.floor(diffMins / 60);
      if (diffHours === 1) return '1 hora';
      return `${diffHours} horas`;
    }

    function mostrarToast(mensagem, tipo) {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      
      const cores = {
        success: 'bg-green-100 border-green-400 text-green-700',
        error: 'bg-red-100 border-red-400 text-red-700',
        info: 'bg-blue-100 border-blue-400 text-blue-700'
      };

      toast.className = `${cores[tipo]} border-l-4 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 translate-x-full`;
      toast.innerHTML = `
        <div class="flex justify-between items-start">
          <p class="text-sm font-medium">${mensagem}</p>
          <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-lg leading-none">&times;</button>
        </div>
      `;

      container.appendChild(toast);
      
      // Anima√ß√£o de entrada
      setTimeout(() => {
        toast.classList.remove('translate-x-full');
      }, 100);

      // Remover automaticamente ap√≥s 5 segundos
      setTimeout(() => {
        if (toast.parentElement) {
          toast.classList.add('translate-x-full');
          setTimeout(() => toast.remove(), 300);
        }
      }, 5000);
    }

    function salvarDados() {
      localStorage.setItem('motoristas', JSON.stringify(motoristas));
      localStorage.setItem('corridas', JSON.stringify(corridas));
      localStorage.setItem('motoristaLogado', JSON.stringify(motoristaLogado));
      localStorage.setItem('estatisticas', JSON.stringify(estatisticas));
    }

    // Atualizar corridas dispon√≠veis periodicamente
    setInterval(() => {
      if (statusMotorista && motoristaLogado) {
        atualizarCorridasDisponiveis();
      }
    }, 5000);
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'959bf03e638df1ea',t:'MTc1MTYwMzk2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

