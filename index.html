



<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MotoT√°xi Tapau√° - Conectando voc√™ ao seu destino</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#000000',
            secondary: '#00D4AA',
            accent: '#FFB800'
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-sm border-b">
    <div class="container mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="bg-primary text-white p-2 rounded-lg">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z"/>
            </svg>
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-900">MotoT√°xi Tapau√°</h1>
            <p class="text-sm text-gray-500">Conectando voc√™ ao seu destino</p>
            <p id="status-dispositivo" class="text-xs text-blue-600">üîÑ Conectando Firebase...</p>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <!-- Indicador de Notifica√ß√µes -->
          <div id="notification-badge" class="relative hidden">
            <svg class="w-6 h-6 text-red-500 animate-pulse" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 19V20H3V19L5 17V11C5 7.9 7 5.2 10 4.3V4C10 2.9 10.9 2 12 2S14 2.9 14 4V4.3C17 5.2 19 7.9 19 11V17L21 19ZM12 22C10.9 22 10 21.1 10 20H14C14 21.1 13.1 22 12 22Z"/>
            </svg>
            <span id="badge-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold">0</span>
          </div>
          
          <div class="flex gap-2">
            <button id="btn-passageiro" onclick="mostrarInterface('passageiro')" 
                    class="px-4 py-2 bg-primary text-white rounded-lg font-medium transition-all hover:bg-gray-800">
              Passageiro
            </button>
            <button id="btn-motorista" onclick="mostrarInterface('motorista')" 
                    class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium transition-all hover:bg-gray-50">
              Motorista
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Interface do Passageiro -->
  <div id="interface-passageiro" class="container mx-auto px-4 py-8 max-w-md">
    <!-- Solicitar Corrida -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
      <div class="text-center mb-6">
        <div class="bg-secondary/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
          </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900 mb-2">Para onde vamos?</h2>
        <p class="text-gray-600">Solicite sua corrida agora</p>
      </div>

      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">üìç Origem</label>
          <div class="relative">
            <input type="text" id="origem" placeholder="Digite o local de partida ou use GPS" 
                   class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-secondary focus:border-transparent">
            <button id="btn-gps-origem" onclick="obterLocalizacaoAtual('origem')" 
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary hover:text-green-600 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
            </button>
          </div>
          <div id="sugestoes-origem" class="hidden mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto"></div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">üéØ Destino</label>
          <div class="relative">
            <input type="text" id="destino" placeholder="Digite o destino ou use GPS" 
                   class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-secondary focus:border-transparent">
            <button id="btn-gps-destino" onclick="obterLocalizacaoAtual('destino')" 
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary hover:text-green-600 transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
            </button>
          </div>
          <div id="sugestoes-destino" class="hidden mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-40 overflow-y-auto"></div>
        </div>
      </div>

      <div class="bg-gray-50 rounded-xl p-4 mb-6">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="bg-primary text-white p-2 rounded-lg">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z"/>
              </svg>
            </div>
            <div>
              <p class="font-semibold text-gray-900">MotoT√°xi</p>
              <p class="text-sm text-gray-600">R√°pido e econ√¥mico</p>
            </div>
          </div>
          <div class="text-right">
            <p class="text-xl font-bold text-gray-900">R$ 5,00</p>
            <p class="text-sm text-gray-500">Pre√ßo fixo</p>
          </div>
        </div>
      </div>

      <button id="btn-solicitar" onclick="solicitarCorrida()" 
              class="w-full bg-primary hover:bg-gray-800 text-white font-semibold py-4 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
        üöÄ Solicitar MotoT√°xi
      </button>
    </div>

    <!-- Status da Corrida -->
    <div id="status-corrida" class="bg-white rounded-2xl shadow-lg p-6 hidden">
      <div class="text-center">
        <div id="status-icon" class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <!-- √çcone ser√° inserido dinamicamente -->
        </div>
        <h3 id="status-titulo" class="text-xl font-bold text-gray-900 mb-2"></h3>
        <p id="status-descricao" class="text-gray-600 mb-6"></p>
        
        <div id="info-motorista" class="bg-gray-50 rounded-xl p-4 mb-4 hidden">
          <div class="flex items-center gap-3">
            <div class="bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg">
              M
            </div>
            <div class="text-left">
              <p id="nome-motorista" class="font-semibold text-gray-900"></p>
              <p class="text-sm text-gray-600">Seu motorista</p>
            </div>
          </div>
        </div>

        <button id="btn-cancelar" onclick="cancelarCorrida()" 
                class="w-full border border-red-300 text-red-600 hover:bg-red-50 font-medium py-3 rounded-xl transition-all">
          Cancelar Corrida
        </button>
      </div>
    </div>
  </div>

  <!-- Interface do Motorista -->
  <div id="interface-motorista" class="container mx-auto px-4 py-8 max-w-md hidden">
    <!-- Cadastro/Login -->
    <div id="cadastro-motorista" class="bg-white rounded-2xl shadow-lg p-6 mb-6">
      <div class="text-center mb-6">
        <div class="bg-accent/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900 mb-2">Seja um Parceiro</h2>
        <p class="text-gray-600">Cadastre-se e comece a ganhar</p>
      </div>

      <div class="space-y-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Nome completo</label>
          <input type="text" id="nome-motorista-input" placeholder="Digite seu nome completo" 
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
          <input type="tel" id="telefone-motorista" placeholder="(XX) XXXXX-XXXX" 
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">CPF</label>
          <input type="text" id="cpf-motorista" placeholder="000.000.000-00" maxlength="14"
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent"
                 oninput="formatarCPF(this)">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Idade</label>
          <input type="number" id="idade-motorista" placeholder="Digite sua idade" min="18" max="80"
                 class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent">
        </div>
      </div>

      <button onclick="cadastrarMotorista()" 
              class="w-full bg-accent hover:bg-yellow-500 text-white font-semibold py-4 rounded-xl transition-all duration-200 transform hover:scale-[1.02] shadow-lg">
        Cadastrar como Motorista
      </button>
    </div>

    <!-- Dashboard do Motorista -->
    <div id="dashboard-motorista" class="hidden">
      <!-- Status Online/Offline -->
      <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
        <div class="flex items-center justify-between mb-4">
          <div>
            <h3 class="text-lg font-bold text-gray-900">Status</h3>
            <p id="status-motorista-texto" class="text-sm text-gray-600">Voc√™ est√° offline</p>
          </div>
          <button id="toggle-status" onclick="toggleStatusMotorista()" 
                  class="bg-gray-300 relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none">
            <span id="toggle-circle" class="inline-block h-6 w-6 transform rounded-full bg-white transition-transform translate-x-1"></span>
          </button>
        </div>
        
        <div class="grid grid-cols-2 gap-4 text-center">
          <div class="bg-green-50 rounded-xl p-3">
            <p class="text-2xl font-bold text-green-600" id="corridas-hoje">0</p>
            <p class="text-sm text-gray-600">Corridas hoje</p>
          </div>
          <div class="bg-blue-50 rounded-xl p-3">
            <p class="text-2xl font-bold text-blue-600" id="ganhos-hoje">R$ 0</p>
            <p class="text-sm text-gray-600">Ganhos hoje</p>
          </div>
        </div>
      </div>

      <!-- Pagamento do Aplicativo -->
      <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
        <div class="flex items-center justify-between mb-4">
          <div>
            <h3 class="text-lg font-bold text-gray-900">Pagamento Di√°rio</h3>
            <p class="text-sm text-gray-600">Taxa di√°ria para usar o aplicativo</p>
          </div>
          <div class="text-right">
            <p class="text-2xl font-bold text-blue-600">R$ 2,00</p>
            <p class="text-sm text-gray-500">Por dia</p>
          </div>
        </div>
        
        <div id="status-pagamento" class="mb-4">
          <!-- Status ser√° inserido dinamicamente -->
        </div>
        
        <button onclick="mostrarPix()" 
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-xl transition-all">
          üí≥ Pagar Aplicativo
        </button>
      </div>

      <!-- Corridas Dispon√≠veis -->
      <div class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-900 mb-4">Corridas Dispon√≠veis</h3>
        <div id="corridas-disponiveis">
          <div class="text-center py-8 text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p>Aguardando corridas...</p>
            <p class="text-sm">Fique online para receber solicita√ß√µes</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Notifica√ß√£o de Corrida -->
  <div id="modal-notificacao" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full transform transition-all">
      <div class="text-center">
        <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce">
          <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">üö® Nova Corrida!</h3>
        <p class="text-gray-600 mb-4">Uma nova corrida est√° dispon√≠vel</p>
        
        <div id="detalhes-corrida-modal" class="bg-gray-50 rounded-xl p-4 mb-6 text-left">
          <p class="font-semibold text-gray-900 mb-1">üìç <span id="modal-origem">-</span></p>
          <p class="text-gray-600 mb-2">üéØ <span id="modal-destino">-</span></p>
          <p class="text-lg font-bold text-green-600">üí∞ R$ 5,00</p>
        </div>

        <div class="flex gap-3">
          <button id="btn-recusar-modal" onclick="fecharModalNotificacao()" 
                  class="flex-1 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-3 rounded-xl transition-all">
            Recusar
          </button>
          <button id="btn-aceitar-modal" onclick="aceitarCorridaModal()" 
                  class="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-xl transition-all">
            Aceitar
          </button>
        </div>
        
        <div class="mt-4">
          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
            <p class="text-sm text-yellow-800">
              ‚è∞ Tempo restante: <span id="tempo-restante" class="font-bold">30s</span>
            </p>
            <div class="w-full bg-yellow-200 rounded-full h-2 mt-2">
              <div id="barra-tempo" class="bg-yellow-500 h-2 rounded-full transition-all duration-1000" style="width: 100%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal PIX -->
  <div id="modal-pix" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full">
      <div class="text-center">
        <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v2a2 2 0 002 2z"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Pagamento PIX</h3>
        <p class="text-gray-600 mb-6">Taxa di√°ria do aplicativo - R$ 2,00</p>
        
        <div class="bg-gray-50 rounded-xl p-4 mb-6">
          <p class="text-sm text-gray-700 mb-2">C√≥digo PIX (CPF):</p>
          <div class="bg-white border-2 border-dashed border-gray-300 rounded-lg p-3 mb-3">
            <p class="font-mono text-lg font-bold text-gray-900" id="codigo-pix">03383948269</p>
          </div>
          <button onclick="copiarPix()" 
                  class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 rounded-lg transition-all">
            üìã Copiar C√≥digo PIX
          </button>
        </div>

        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6">
          <p class="text-sm text-yellow-800">
            ‚ö†Ô∏è <strong>Importante:</strong> O pagamento deve ser feito diariamente para manter o acesso ao aplicativo.
          </p>
        </div>

        <div class="flex gap-3">
          <button onclick="fecharModalPix()" 
                  class="flex-1 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-3 rounded-xl transition-all">
            Fechar
          </button>
          <button onclick="marcarComoPago()" 
                  class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-xl transition-all">
            ‚úÖ J√° Paguei
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <!-- Bot√£o √Årea Administrativa -->
  <div class="fixed bottom-4 left-4 z-40">
    <button onclick="abrirAreaAdministrativa()" 
            class="bg-gray-800 hover:bg-gray-900 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium transition-all">
      üîê √Årea Administrativa
    </button>
  </div>

  <!-- Modal de Login Administrativo -->
  <div id="modal-login-admin" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full">
      <div class="text-center mb-6">
        <div class="bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Acesso Administrativo</h3>
        <p class="text-gray-600">Digite a senha para continuar</p>
      </div>

      <div class="mb-6">
        <input type="password" id="senha-admin" placeholder="Digite a senha" 
               class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-gray-500 focus:border-transparent"
               onkeypress="if(event.key==='Enter') verificarSenhaAdmin()">
      </div>

      <div class="flex gap-3">
        <button onclick="fecharModalLoginAdmin()" 
                class="flex-1 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-3 rounded-xl transition-all">
          Cancelar
        </button>
        <button onclick="verificarSenhaAdmin()" 
                class="flex-1 bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 rounded-xl transition-all">
          Entrar
        </button>
      </div>
    </div>
  </div>

  <!-- Interface Administrativa -->
  <div id="interface-admin" class="fixed inset-0 bg-gray-50 z-50 hidden overflow-y-auto">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
      <!-- Header Admin -->
      <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-2xl font-bold text-gray-900">√Årea Administrativa</h1>
            <p class="text-gray-600">Gerenciamento completo da plataforma</p>
          </div>
          <button onclick="sairAreaAdmin()" 
                  class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-all">
            Sair
          </button>
        </div>
      </div>

      <!-- Estat√≠sticas -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
        <div class="bg-white rounded-xl shadow-lg p-6">
          <div class="flex items-center">
            <div class="bg-blue-100 p-3 rounded-full">
              <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-2xl font-bold text-gray-900" id="total-motoristas">0</p>
              <p class="text-sm text-gray-600">Total de Motoristas</p>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6">
          <div class="flex items-center">
            <div class="bg-green-100 p-3 rounded-full">
              <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-2xl font-bold text-green-600" id="motoristas-online">0</p>
              <p class="text-sm text-gray-600">Motoristas Online</p>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6">
          <div class="flex items-center">
            <div class="bg-yellow-100 p-3 rounded-full">
              <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-2xl font-bold text-yellow-600" id="corridas-ativas">0</p>
              <p class="text-sm text-gray-600">Corridas Ativas</p>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg p-6">
          <div class="flex items-center">
            <div class="bg-red-100 p-3 rounded-full">
              <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
              </svg>
            </div>
            <div class="ml-4">
              <p class="text-2xl font-bold text-red-600" id="motoristas-atraso">0</p>
              <p class="text-sm text-gray-600">Com Pagamento Atrasado</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Lista de Motoristas -->
      <div class="bg-white rounded-2xl shadow-lg p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-bold text-gray-900">Motoristas Cadastrados</h2>
          <div class="flex gap-3">
            <button onclick="notificarTodosAtrasados()" 
                    class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg font-medium transition-all">
              üì¢ Notificar Todos em Atraso
            </button>
            <button onclick="atualizarListaMotoristas()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-all">
              üîÑ Atualizar
            </button>
          </div>
        </div>
        
        <div id="lista-motoristas-admin">
          <div class="text-center py-8 text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
            </svg>
            <p>Carregando motoristas...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Confirma√ß√£o de Remo√ß√£o -->
  <div id="modal-confirmar-remocao" class="fixed inset-0 bg-black bg-opacity-50 z-60 hidden flex items-center justify-center">
    <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full">
      <div class="text-center">
        <div class="bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Confirmar Remo√ß√£o</h3>
        <p class="text-gray-600 mb-6">Tem certeza que deseja remover este motorista da plataforma?</p>
        
        <div id="info-motorista-remocao" class="bg-gray-50 rounded-xl p-4 mb-6 text-left">
          <!-- Informa√ß√µes do motorista ser√£o inseridas aqui -->
        </div>

        <div class="flex gap-3">
          <button onclick="cancelarRemocao()" 
                  class="flex-1 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-3 rounded-xl transition-all">
            Cancelar
          </button>
          <button id="btn-confirmar-remocao" onclick="confirmarRemocaoMotorista()" 
                  class="flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-3 rounded-xl transition-all">
            Remover
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Notifica√ß√£o Personalizada -->
  <div id="modal-notificacao-personalizada" class="fixed inset-0 bg-black bg-opacity-50 z-60 hidden flex items-center justify-center">
    <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-md w-full">
      <div class="text-center mb-6">
        <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4 19h6v-2H4v2zM4 15h8v-2H4v2zM4 11h8V9H4v2z"/>
          </svg>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">Enviar Notifica√ß√£o</h3>
        <p class="text-gray-600">Envie uma mensagem personalizada para o motorista</p>
      </div>

      <div class="mb-6">
        <div id="info-motorista-notificacao" class="bg-gray-50 rounded-xl p-4 mb-4">
          <!-- Informa√ß√µes do motorista ser√£o inseridas aqui -->
        </div>
        
        <label class="block text-sm font-medium text-gray-700 mb-2">Mensagem:</label>
        <textarea id="mensagem-notificacao" rows="4" 
                  class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                  placeholder="Digite sua mensagem aqui..."></textarea>
      </div>

      <div class="flex gap-3">
        <button onclick="cancelarNotificacao()" 
                class="flex-1 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-3 rounded-xl transition-all">
          Cancelar
        </button>
        <button onclick="enviarNotificacaoPersonalizada()" 
                class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-xl transition-all">
          üì§ Enviar
        </button>
      </div>
    </div>
  </div>

  <script>
    // Configura√ß√£o do Firebase
    const firebaseConfig = {
apiKey: "AIzaSyC7p8sFN6eOy1vwUOGCkQLpnIiGkRbCS3o",
  authDomain: "m-taxi-37c8f.firebaseapp.com",
  projectId: "m-taxi-37c8f",
  storageBucket: "m-taxi-37c8f.firebasestorage.app",
  messagingSenderId: "1028876997049",
  appId: "1:1028876997049:web:7bfc5fb4a12e3b0613e668",
  measurementId: "G-H60HNCY2MC"
    };

    // Inicializar Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    
    // Estado da aplica√ß√£o
    let motoristas = [];
    let corridas = [];
    let motoristaLogado = JSON.parse(localStorage.getItem('motoristaLogado') || 'null');
    let corridaAtual = null;
    let statusMotorista = false;
    let estatisticas = JSON.parse(localStorage.getItem('estatisticas') || '{"corridas": 0, "ganhos": 0}');
    let localizacaoAtual = null;
    
    // Vari√°veis para notifica√ß√µes
    let corridaNotificacao = null;
    let timerNotificacao = null;
    let tempoRestante = 30;
    let audioNotificacao = null;
    let notificacoesAtivas = 0;
    
    // Vari√°veis para comunica√ß√£o entre dispositivos
    let dispositivoId = localStorage.getItem('dispositivoId') || gerarIdDispositivo();
    let ultimaAtualizacao = 0;
    let corridasAnteriores = [];
    let firebaseListeners = [];
    
    // Vari√°veis administrativas
    let motoristaParaRemover = null;
    let motoristaParaNotificar = null;
    const SENHA_ADMIN = '@Zxcasdqwe123';

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      mostrarInterface('passageiro');
      inicializarFirebase();

function inicializarFirebase() {
  console.log("Firebase inicializado");
  atualizarStatusDispositivo("‚úÖ Firebase conectado");
}

      if (motoristaLogado) {
        mostrarDashboardMotorista();
        verificarNotificacoes();
      }
      atualizarEstatisticas();
      verificarCorridasPendentes();
      configurarAutoComplete();
      inicializarNotificacoes();
      criarAudioChamada();
    });

    // Navega√ß√£o entre interfaces
    function mostrarInterface(tipo) {
      const passageiroDiv = document.getElementById('interface-passageiro');
      const motoristaDiv = document.getElementById('interface-motorista');
      const btnPassageiro = document.getElementById('btn-passageiro');
      const btnMotorista = document.getElementById('btn-motorista');

      if (tipo === 'passageiro') {
        passageiroDiv.classList.remove('hidden');
        motoristaDiv.classList.add('hidden');
        btnPassageiro.className = 'px-4 py-2 bg-primary text-white rounded-lg font-medium transition-all hover:bg-gray-800';
        btnMotorista.className = 'px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium transition-all hover:bg-gray-50';
      } else {
        passageiroDiv.classList.add('hidden');
        motoristaDiv.classList.remove('hidden');
        btnPassageiro.className = 'px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium transition-all hover:bg-gray-50';
        btnMotorista.className = 'px-4 py-2 bg-primary text-white rounded-lg font-medium transition-all hover:bg-gray-800';
      }
    }

    // Fun√ß√µes do Passageiro
    function solicitarCorrida() {
      const origem = document.getElementById('origem').value.trim();
      const destino = document.getElementById('destino').value.trim();

      if (!origem || !destino) {
        mostrarToast('Por favor, preencha origem e destino', 'error');
        return;
      }

      const corrida = {
        id: Date.now(),
        origem,
        destino,
        status: 'aguardando',
        criadaEm: new Date().toISOString(),
        valor: 5.00,
        motoristaId: null,
        nomeMotorista: null,
        passageiroId: dispositivoId
      };

      corridaAtual = corrida;
      
      // Salvar corrida no Firebase
      database.ref('corridas/' + corrida.id).set(corrida)
        .then(() => {
          mostrarStatusCorrida('aguardando');
          mostrarToast('Corrida solicitada! Procurando motorista...', 'info');
          atualizarStatusDispositivo('üì§ Corrida enviada');
          
          // Tocar alarme para motoristas online
          tocarAlarmeMotoristasOnline();
        })
        .catch((error) => {
          console.error('Erro ao solicitar corrida:', error);
          mostrarToast('Erro ao solicitar corrida. Tente novamente.', 'error');
          atualizarStatusDispositivo('‚ùå Erro ao enviar');
        });
    }

    function mostrarStatusCorrida(status) {
      const solicitarDiv = document.querySelector('#interface-passageiro > div:first-child');
      const statusDiv = document.getElementById('status-corrida');
      const statusIcon = document.getElementById('status-icon');
      const statusTitulo = document.getElementById('status-titulo');
      const statusDescricao = document.getElementById('status-descricao');
      const infoMotorista = document.getElementById('info-motorista');

      solicitarDiv.classList.add('hidden');
      statusDiv.classList.remove('hidden');

      switch(status) {
        case 'aguardando':
          statusIcon.className = 'w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-yellow-100 animate-pulse';
          statusIcon.innerHTML = '<svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>';
          statusTitulo.textContent = 'Procurando motorista...';
          statusDescricao.textContent = 'Aguarde enquanto encontramos um motorista pr√≥ximo a voc√™';
          infoMotorista.classList.add('hidden');
          break;
        case 'aceita':
          statusIcon.className = 'w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-green-100';
          statusIcon.innerHTML = '<svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>';
          statusTitulo.textContent = 'Corrida aceita!';
          statusDescricao.textContent = 'O motorista est√° a caminho do local de partida';
          infoMotorista.classList.remove('hidden');
          document.getElementById('nome-motorista').textContent = corridaAtual.nomeMotorista;
          break;
        case 'finalizada':
          statusIcon.className = 'w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-blue-100';
          statusIcon.innerHTML = '<svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>';
          statusTitulo.textContent = 'Corrida finalizada!';
          statusDescricao.textContent = 'Obrigado por usar nosso servi√ßo. Avalie sua experi√™ncia!';
          infoMotorista.classList.remove('hidden');
          setTimeout(() => {
            voltarParaSolicitacao();
          }, 3000);
          break;
      }
    }

    function cancelarCorrida() {
      if (corridaAtual) {
        // Remover corrida do Firebase
        database.ref('corridas/' + corridaAtual.id).remove()
          .then(() => {
            voltarParaSolicitacao();
            mostrarToast('Corrida cancelada', 'info');
            atualizarStatusDispositivo('‚ùå Corrida cancelada');
          })
          .catch((error) => {
            console.error('Erro ao cancelar corrida:', error);
            mostrarToast('Erro ao cancelar corrida', 'error');
          });
      }
    }

    function voltarParaSolicitacao() {
      const solicitarDiv = document.querySelector('#interface-passageiro > div:first-child');
      const statusDiv = document.getElementById('status-corrida');
      
      solicitarDiv.classList.remove('hidden');
      statusDiv.classList.add('hidden');
      
      // Limpar campos
      document.getElementById('origem').value = '';
      document.getElementById('destino').value = '';
      corridaAtual = null;
    }

    // Fun√ß√µes do Motorista
    function cadastrarMotorista() {
      const nome = document.getElementById('nome-motorista-input').value.trim();
      const telefone = document.getElementById('telefone-motorista').value.trim();
      const cpf = document.getElementById('cpf-motorista').value.trim();
      const idade = document.getElementById('idade-motorista').value.trim();

      if (!nome || !telefone || !cpf || !idade) {
        mostrarToast('Por favor, preencha todos os campos', 'error');
        return;
      }

      if (!validarCPF(cpf)) {
        mostrarToast('CPF inv√°lido. Digite um CPF v√°lido.', 'error');
        return;
      }

      if (parseInt(idade) < 18 || parseInt(idade) > 80) {
        mostrarToast('A idade deve estar entre 18 e 80 anos', 'error');
        return;
      }

      const motorista = {
        id: dispositivoId,
        nome,
        telefone,
        cpf,
        idade: parseInt(idade),
        cadastradoEm: new Date().toISOString(),
        online: false,
        ultimaAtividade: new Date().toISOString(),
        ultimoPagamento: null,
        diasAtraso: 0
      };

      motoristaLogado = motorista;
      localStorage.setItem('motoristaLogado', JSON.stringify(motorista));
      
      // Salvar motorista no Firebase
      database.ref('motoristas/' + motorista.id).set(motorista)
        .then(() => {
          mostrarDashboardMotorista();
          mostrarToast('Cadastro realizado com sucesso!', 'success');
          atualizarStatusDispositivo('‚úÖ Motorista cadastrado');
        })
        .catch((error) => {
          console.error('Erro ao cadastrar motorista:', error);
          mostrarToast('Erro ao cadastrar. Tente novamente.', 'error');
          atualizarStatusDispositivo('‚ùå Erro no cadastro');
        });
    }

    function mostrarDashboardMotorista() {
      document.getElementById('cadastro-motorista').classList.add('hidden');
      document.getElementById('dashboard-motorista').classList.remove('hidden');
      atualizarEstatisticas();
      atualizarStatusPagamento();
    }

    function toggleStatusMotorista() {
      statusMotorista = !statusMotorista;
      const toggle = document.getElementById('toggle-status');
      const circle = document.getElementById('toggle-circle');
      const statusTexto = document.getElementById('status-motorista-texto');

      if (statusMotorista) {
        toggle.className = 'bg-green-500 relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none';
        circle.className = 'inline-block h-6 w-6 transform rounded-full bg-white transition-transform translate-x-7';
        statusTexto.textContent = 'Voc√™ est√° online';
        mostrarToast('Voc√™ est√° online! Aguardando corridas...', 'success');
      } else {
        toggle.className = 'bg-gray-300 relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none';
        circle.className = 'inline-block h-6 w-6 transform rounded-full bg-white transition-transform translate-x-1';
        statusTexto.textContent = 'Voc√™ est√° offline';
        mostrarToast('Voc√™ est√° offline', 'info');
      }

      if (motoristaLogado) {
        motoristaLogado.online = statusMotorista;
        motoristaLogado.ultimaAtividade = new Date().toISOString();
        
        // Atualizar status no Firebase
        database.ref('motoristas/' + motoristaLogado.id).update({
          online: statusMotorista,
          ultimaAtividade: motoristaLogado.ultimaAtividade
        }).then(() => {
          atualizarStatusDispositivo(statusMotorista ? 'üü¢ Online' : 'üî¥ Offline');
        }).catch((error) => {
          console.error('Erro ao atualizar status:', error);
          atualizarStatusDispositivo('‚ùå Erro de conex√£o');
        });
      }

      atualizarCorridasDisponiveis();
    }

    function aceitarCorrida(corridaId) {
      if (!motoristaLogado) return;
      
      // Parar alarme
      pararAlarme();
      
      // Atualizar corrida no Firebase
      database.ref('corridas/' + corridaId).update({
        status: 'aceita',
        motoristaId: motoristaLogado.id,
        nomeMotorista: motoristaLogado.nome,
        aceitaEm: new Date().toISOString()
      }).then(() => {
        mostrarToast('Corrida aceita! Dirija-se ao local de partida', 'success');
        atualizarStatusDispositivo('‚úÖ Corrida aceita');
      }).catch((error) => {
        console.error('Erro ao aceitar corrida:', error);
        mostrarToast('Erro ao aceitar corrida. Tente novamente.', 'error');
        atualizarStatusDispositivo('‚ùå Erro ao aceitar');
      });
    }

    function finalizarCorrida(corridaId) {
      if (!motoristaLogado) return;
      
      // Atualizar corrida no Firebase
      database.ref('corridas/' + corridaId).update({
        status: 'finalizada',
        finalizadaEm: new Date().toISOString()
      }).then(() => {
        // Atualizar estat√≠sticas locais
        estatisticas.corridas += 1;
        estatisticas.ganhos += 4; // R$ 4 para o motorista
        localStorage.setItem('estatisticas', JSON.stringify(estatisticas));
        
        atualizarEstatisticas();
        mostrarToast('Corrida finalizada! Voc√™ ganhou R$ 4,00', 'success');
        atualizarStatusDispositivo('‚úÖ Corrida finalizada');
      }).catch((error) => {
        console.error('Erro ao finalizar corrida:', error);
        mostrarToast('Erro ao finalizar corrida. Tente novamente.', 'error');
        atualizarStatusDispositivo('‚ùå Erro ao finalizar');
      });
    }

    function atualizarCorridasDisponiveis() {
      const container = document.getElementById('corridas-disponiveis');
      const corridasAguardando = corridas.filter(c => c.status === 'aguardando');
      const corridasAceitas = corridas.filter(c => c.status === 'aceita' && c.motoristaId === motoristaLogado?.id);

      if (!statusMotorista || (corridasAguardando.length === 0 && corridasAceitas.length === 0)) {
        container.innerHTML = `
          <div class="text-center py-8 text-gray-500">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <p>Aguardando corridas...</p>
            <p class="text-sm">${statusMotorista ? 'Fique atento √†s novas solicita√ß√µes' : 'Fique online para receber solicita√ß√µes'}</p>
          </div>
        `;
        return;
      }

      container.innerHTML = '';

      // Mostrar corridas aceitas pelo motorista
      corridasAceitas.forEach(corrida => {
        const div = document.createElement('div');
        div.className = 'border-2 border-green-200 bg-green-50 rounded-xl p-4 mb-4';
        div.innerHTML = `
          <div class="flex justify-between items-start mb-3">
            <div>
              <p class="font-semibold text-gray-900">üìç ${corrida.origem}</p>
              <p class="text-gray-600">üéØ ${corrida.destino}</p>
            </div>
            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">
              Em andamento
            </span>
          </div>
          <div class="flex justify-between items-center">
            <p class="text-lg font-bold text-green-600">R$ 5,00</p>
            <button onclick="finalizarCorrida(${corrida.id})" 
                    class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
              Finalizar Corrida
            </button>
          </div>
        `;
        container.appendChild(div);
      });

      // Mostrar corridas dispon√≠veis
      corridasAguardando.forEach(corrida => {
        const div = document.createElement('div');
        div.className = 'border border-gray-200 bg-white rounded-xl p-4 mb-4 hover:shadow-md transition-shadow';
        div.innerHTML = `
          <div class="flex justify-between items-start mb-3">
            <div>
              <p class="font-semibold text-gray-900">üìç ${corrida.origem}</p>
              <p class="text-gray-600">üéØ ${corrida.destino}</p>
              <p class="text-sm text-gray-500">Solicitada h√° ${calcularTempoDecorrido(corrida.criadaEm)}</p>
            </div>
            <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium">
              Dispon√≠vel
            </span>
          </div>
          <div class="flex justify-between items-center">
            <p class="text-lg font-bold text-gray-900">R$ 5,00</p>
            <button onclick="aceitarCorrida(${corrida.id})" 
                    class="bg-primary hover:bg-gray-800 text-white px-4 py-2 rounded-lg font-medium transition-colors">
              Aceitar Corrida
            </button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function atualizarEstatisticas() {
      document.getElementById('corridas-hoje').textContent = estatisticas.corridas;
      document.getElementById('ganhos-hoje').textContent = `R$ ${estatisticas.ganhos}`;
    }

    // Fun√ß√µes de Geolocaliza√ß√£o
    function obterLocalizacaoAtual(campo) {
      const botao = document.getElementById(`btn-gps-${campo}`);
      const input = document.getElementById(campo);
      
      // Mostrar loading no bot√£o
      botao.innerHTML = `
        <svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
        </svg>
      `;
      
      if (!navigator.geolocation) {
        mostrarToast('GPS n√£o dispon√≠vel neste dispositivo', 'error');
        restaurarBotaoGPS(botao);
        return;
      }

      const opcoes = {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 60000
      };

      navigator.geolocation.getCurrentPosition(
        function(posicao) {
          const lat = posicao.coords.latitude;
          const lng = posicao.coords.longitude;
          
          localizacaoAtual = { lat, lng };
          
          // Converter coordenadas em endere√ßo
          obterEnderecoReverso(lat, lng, campo);
          
          mostrarToast('Localiza√ß√£o obtida com sucesso!', 'success');
          restaurarBotaoGPS(botao);
        },
        function(erro) {
          let mensagem = 'Erro ao obter localiza√ß√£o';
          
          switch(erro.code) {
            case erro.PERMISSION_DENIED:
              mensagem = 'Permiss√£o de localiza√ß√£o negada. Ative o GPS e permita o acesso.';
              break;
            case erro.POSITION_UNAVAILABLE:
              mensagem = 'Localiza√ß√£o indispon√≠vel. Verifique se o GPS est√° ativo.';
              break;
            case erro.TIMEOUT:
              mensagem = 'Tempo limite para obter localiza√ß√£o. Tente novamente.';
              break;
          }
          
          mostrarToast(mensagem, 'error');
          restaurarBotaoGPS(botao);
        },
        opcoes
      );
    }

    function restaurarBotaoGPS(botao) {
      botao.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
        </svg>
      `;
    }

    function obterEnderecoReverso(lat, lng, campo) {
      // Simula√ß√£o de geocodifica√ß√£o reversa com locais conhecidos de Tapau√°-AM
      const locaisConhecidos = [
        { nome: "Centro de Tapau√°", lat: -5.1, lng: -63.2, raio: 0.01 },
        { nome: "Porto de Tapau√°", lat: -5.11, lng: -63.19, raio: 0.01 },
        { nome: "Mercado Municipal", lat: -5.09, lng: -63.21, raio: 0.01 },
        { nome: "Igreja Matriz", lat: -5.1, lng: -63.2, raio: 0.005 },
        { nome: "Prefeitura Municipal", lat: -5.098, lng: -63.201, raio: 0.008 },
        { nome: "Hospital Municipal", lat: -5.102, lng: -63.198, raio: 0.01 },
        { nome: "Escola Estadual Amazonas", lat: -5.12, lng: -63.18, raio: 0.01 },
        { nome: "Terminal Rodovi√°rio", lat: -5.095, lng: -63.205, raio: 0.01 },
        { nome: "Banco do Brasil", lat: -5.099, lng: -63.199, raio: 0.005 },
        { nome: "Feira Livre", lat: -5.101, lng: -63.202, raio: 0.008 },
        { nome: "Vila Nova", lat: -5.105, lng: -63.195, raio: 0.015 },
        { nome: "Beira Rio", lat: -5.108, lng: -63.188, raio: 0.012 },
        { nome: "Setor Comercial", lat: -5.097, lng: -63.203, raio: 0.01 },
        { nome: "Pra√ßa Central", lat: -5.1, lng: -63.2, raio: 0.005 }
      ];

      let enderecoEncontrado = null;
      
      for (let local of locaisConhecidos) {
        const distancia = Math.sqrt(
          Math.pow(lat - local.lat, 2) + Math.pow(lng - local.lng, 2)
        );
        
        if (distancia <= local.raio) {
          enderecoEncontrado = local.nome;
          break;
        }
      }

      if (!enderecoEncontrado) {
        // Se n√£o encontrou um local conhecido, usar o centro como refer√™ncia
        enderecoEncontrado = "Centro de Tapau√°";
      }

      document.getElementById(campo).value = enderecoEncontrado;
    }

    // Configurar autocomplete para endere√ßos
    function configurarAutoComplete() {
      const enderecosTapaua = [
        // Bairros e Regi√µes
        "Centro de Tapau√°",
        "Vila Nova",
        "Beira Rio", 
        "Setor Comercial",
        "Vila S√£o Jos√©",
        "Conjunto Habitacional",
        "√Årea Portu√°ria",
        "Zona Rural",
        
        // Estabelecimentos Comerciais
        "Mercado Municipal",
        "Supermercado Central",
        "Supermercado S√£o Jos√©",
        "Mercadinho da Vila",
        "Farm√°cia Central",
        "Farm√°cia S√£o Paulo",
        "Drogaria Popular",
        "Padaria S√£o Jos√©",
        "Padaria Central",
        "A√ßougue do Centro",
        "Loja de Roupas Elegante",
        "Casa de Materiais de Constru√ß√£o",
        "Loja de Eletrodom√©sticos",
        "Papelaria Escolar",
        
        // Servi√ßos P√∫blicos
        "Prefeitura Municipal",
        "C√¢mara Municipal",
        "F√≥rum de Tapau√°",
        "Delegacia de Pol√≠cia",
        "Corpo de Bombeiros",
        "Correios",
        "Cart√≥rio",
        "Receita Federal",
        "INSS",
        
        // Bancos e Financeiras
        "Banco do Brasil",
        "Caixa Econ√¥mica Federal",
        "Bradesco",
        "Banco da Amaz√¥nia",
        "Lot√©rica",
        "Casa Lot√©rica Central",
        
        // Sa√∫de
        "Hospital Municipal",
        "Posto de Sa√∫de Central",
        "UBS Vila Nova",
        "Cl√≠nica M√©dica",
        "Laborat√≥rio de An√°lises",
        "Consult√≥rio Odontol√≥gico",
        
        // Educa√ß√£o
        "Escola Municipal Jos√© da Silva",
        "Escola Estadual Amazonas",
        "Col√©gio S√£o Jos√©",
        "Creche Municipal",
        "Centro de Educa√ß√£o Infantil",
        
        // Transporte e Combust√≠vel
        "Terminal Rodovi√°rio",
        "Porto de Tapau√°",
        "Posto de Combust√≠vel BR",
        "Posto Shell",
        "Oficina Mec√¢nica Central",
        "Borracharia",
        
        // Lazer e Cultura
        "Pra√ßa Central",
        "Pra√ßa da Igreja",
        "Campo de Futebol Municipal",
        "Quadra Poliesportiva",
        "Centro Cultural",
        "Biblioteca Municipal",
        
        // Religioso
        "Igreja Matriz",
        "Igreja Assembleia de Deus",
        "Igreja Batista",
        "Igreja Universal",
        "Capela S√£o Jos√©",
        
        // Outros Pontos
        "Cemit√©rio Municipal",
        "Feira Livre",
        "Mercado de Peixe",
        "Rodovi√°ria",
        "Aeroporto Regional",
        "Marina",
        "Clube Social",
        "Hotel Tapau√°",
        "Pousada Central",
        "Restaurante do Porto",
        "Lanchonete da Pra√ßa",
        "Pizzaria Bella Vista"
      ];

      configurarCampoAutoComplete('origem', enderecosTapaua);
      configurarCampoAutoComplete('destino', enderecosTapaua);
    }

    function configurarCampoAutoComplete(campoId, sugestoes) {
      const input = document.getElementById(campoId);
      const containerSugestoes = document.getElementById(`sugestoes-${campoId}`);

      input.addEventListener('input', function() {
        const valor = this.value.toLowerCase();
        
        if (valor.length < 2) {
          containerSugestoes.classList.add('hidden');
          return;
        }

        const sugestoesFiltradas = sugestoes.filter(endereco => 
          endereco.toLowerCase().includes(valor)
        );

        if (sugestoesFiltradas.length === 0) {
          containerSugestoes.classList.add('hidden');
          return;
        }

        containerSugestoes.innerHTML = '';
        containerSugestoes.classList.remove('hidden');

        sugestoesFiltradas.slice(0, 5).forEach(endereco => {
          const div = document.createElement('div');
          div.className = 'px-4 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0';
          div.textContent = endereco;
          
          div.addEventListener('click', function() {
            input.value = endereco;
            containerSugestoes.classList.add('hidden');
          });
          
          containerSugestoes.appendChild(div);
        });
      });

      // Fechar sugest√µes ao clicar fora
      document.addEventListener('click', function(e) {
        if (!input.contains(e.target) && !containerSugestoes.contains(e.target)) {
          containerSugestoes.classList.add('hidden');
        }
      });
    }

    // Fun√ß√µes de Notifica√ß√£o e Alarme
    function inicializarNotificacoes() {
      // Solicitar permiss√£o para notifica√ß√µes
      if ('Notification' in window && Notification.permission === 'default') {
        Notification.requestPermission();
      }
    }

    // Criar √°udio de chamada para motoristas
    let audioAlarme = null;
    let intervalAlarme = null;

    function criarAudioChamada() {
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Fun√ß√£o para criar som de chamada telef√¥nica
        window.criarSomChamada = function() {
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);
          
          // Frequ√™ncias t√≠picas de toque de telefone
          oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // L√°
          oscillator.frequency.setValueAtTime(480, audioContext.currentTime + 0.4); // Si bemol
          
          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
          
          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.8);
        };
      } catch (e) {
        console.log('√Åudio n√£o dispon√≠vel');
      }
    }

    function tocarAlarmeMotoristasOnline() {
      // Verificar se h√° motoristas online
      const motoristasOnline = motoristas.filter(m => m.online);
      
      if (motoristasOnline.length === 0) {
        mostrarToast('Nenhum motorista online no momento', 'info');
        return;
      }

      // Para cada motorista online, simular alarme
      motoristasOnline.forEach(motorista => {<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'95a1cbc056275731',t:'MTc1MTY2NTM4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
